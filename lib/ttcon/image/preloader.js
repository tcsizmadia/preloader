dojo.provide("ttcon.image.preloader");
dojo.declare("ttcon.image.preloader",null,{constructor:function(a){this.VERSION="0.1.5";this._images=[];this._currentImage=this._numImagesLoaded=this._numOfImages=0;dojo.isArray(a)&&this.add(a);return this},_addImage:function(a){if(dojo.isString(a)){this._images.push(a);this._numOfImages++}},_preloadOne:function(a,c){var b=dojo.create("img",{id:"pre"+c,src:a,style:{position:"absolute",left:"-9999px",top:"0px"}},dojo.body(),"last");dojo.connect(b,"onload",this,function(){this._numImagesLoaded++;dojo.publish("ttcon/preloader/image-loaded",
[{current:this._numImagesLoaded,total:this._numOfImages,src:b.src}]);this.onImageLoaded({current:this._numImagesLoaded,total:this._numOfImages,src:b.src});if(this._numImagesLoaded==this._numOfImages){dojo.publish("ttcon/preloader/done",[{total:this._numImagesLoaded}]);this.onPreloadDone({total:this._numImagesLoaded})}dojo.destroy(b)})},onImageLoaded:function(){},onPreloadDone:function(){},add:function(a){dojo.isArray(a)?dojo.forEach(a,this._addImage,this):this._addImage(a);return this},preload:function(){dojo.forEach(this._images,
this._preloadOne,this);return this},clear:function(){this._images=[];this._currentImage=this._numImagesLoaded=this._numOfImages=0;dojo.publish("ttcon/preloader/cleared",[]);return true}});
